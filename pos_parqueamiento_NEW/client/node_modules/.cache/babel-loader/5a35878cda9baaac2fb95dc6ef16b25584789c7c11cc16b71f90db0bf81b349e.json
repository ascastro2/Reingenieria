{"ast":null,"code":"import _objectSpread from\"C:/Users/Asus/Documents/GitHub/Reingenieria/pos_parqueamiento_NEW/client/node_modules/@babel/runtime/helpers/esm/objectSpread2.js\";import React,{useState,useEffect}from'react';import{Box,Typography,Button,Card,CardContent,Grid,Chip,IconButton,Tooltip,Dialog,DialogTitle,DialogContent,DialogActions,TextField,FormControl,InputLabel,Select,MenuItem,Alert,CircularProgress,Paper,Table,TableBody,TableCell,TableContainer,TableHead,TableRow,TablePagination}from'@mui/material';import{Add as AddIcon,Receipt as ReceiptIcon,Refresh as RefreshIcon,CheckCircle as CheckCircleIcon,Cancel as CancelIcon,Visibility as VisibilityIcon}from'@mui/icons-material';import axios from'axios';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const Ventas=()=>{const[ventas,setVentas]=useState([]);const[espacios,setEspacios]=useState([]);const[clientes,setClientes]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);const[openDialog,setOpenDialog]=useState(false);const[openFinalizarDialog,setOpenFinalizarDialog]=useState(false);const[openCancelarDialog,setOpenCancelarDialog]=useState(false);const[selectedVenta,setSelectedVenta]=useState(null);const[page,setPage]=useState(0);const[rowsPerPage,setRowsPerPage]=useState(10);const[searchTerm,setSearchTerm]=useState('');const[isSubmitting,setIsSubmitting]=useState(false);const[formData,setFormData]=useState({id_espacio:0,id_cliente:undefined,placa_vehiculo:'',tipo_vehiculo:'auto',observaciones:''});const[finalizarForm,setFinalizarForm]=useState({observaciones_salida:''});const[cancelarForm,setCancelarForm]=useState({motivo_cancelacion:''});const fetchData=async()=>{try{setLoading(true);setError(null);const[ventasResponse,espaciosResponse,clientesResponse]=await Promise.all([axios.get('/api/ventas'),axios.get('/api/espacios/libres'),axios.get('/api/clientes')]);console.log('Ventas recibidas:',ventasResponse.data.data);console.log('Espacios recibidos:',espaciosResponse.data.data);console.log('Clientes recibidos:',clientesResponse.data.data);setVentas(ventasResponse.data.data);setEspacios(espaciosResponse.data.data);setClientes(clientesResponse.data.data);}catch(error){console.error('Error al cargar datos:',error);setError('Error al cargar los datos');}finally{setLoading(false);}};useEffect(()=>{fetchData();},[]);const handleOpenDialog=()=>{setFormData({id_espacio:0,id_cliente:undefined,placa_vehiculo:'',tipo_vehiculo:'auto',observaciones:''});setOpenDialog(true);};const handleCloseDialog=()=>{setOpenDialog(false);setFormData({id_espacio:0,id_cliente:undefined,placa_vehiculo:'',tipo_vehiculo:'auto',observaciones:''});};const handleSubmit=async()=>{if(isSubmitting)return;try{if(!formData.id_espacio||!formData.placa_vehiculo.trim()){setError('Por favor complete todos los campos requeridos');return;}setIsSubmitting(true);await axios.post('/api/ventas',formData);fetchData();handleCloseDialog();}catch(error){var _error$response,_error$response$data;console.error('Error al crear venta:',error);setError(((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.error)||'Error al crear la venta');}finally{setIsSubmitting(false);}};const handleFinalizar=async()=>{if(!selectedVenta||isSubmitting)return;try{setIsSubmitting(true);await axios.put(\"/api/ventas/\".concat(selectedVenta.id_venta,\"/finalizar\"),finalizarForm);fetchData();setOpenFinalizarDialog(false);setSelectedVenta(null);setFinalizarForm({observaciones_salida:''});}catch(error){var _error$response2;console.error('Error al finalizar venta:',error);if(((_error$response2=error.response)===null||_error$response2===void 0?void 0:_error$response2.status)===429){setError('Demasiadas peticiones. Por favor espera un momento antes de intentar nuevamente.');}else{var _error$response3,_error$response3$data;setError(((_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:_error$response3$data.error)||'Error al finalizar la venta');}}finally{setIsSubmitting(false);}};const handleCancelar=async()=>{if(!selectedVenta||isSubmitting)return;try{setIsSubmitting(true);await axios.put(\"/api/ventas/\".concat(selectedVenta.id_venta,\"/cancelar\"),cancelarForm);fetchData();setOpenCancelarDialog(false);setSelectedVenta(null);setCancelarForm({motivo_cancelacion:''});}catch(error){var _error$response4;console.error('Error al cancelar venta:',error);if(((_error$response4=error.response)===null||_error$response4===void 0?void 0:_error$response4.status)===429){setError('Demasiadas peticiones. Por favor espera un momento antes de intentar nuevamente.');}else{var _error$response5,_error$response5$data;setError(((_error$response5=error.response)===null||_error$response5===void 0?void 0:(_error$response5$data=_error$response5.data)===null||_error$response5$data===void 0?void 0:_error$response5$data.error)||'Error al cancelar la venta');}}finally{setIsSubmitting(false);}};const openFinalizarVenta=venta=>{if(!venta||!venta.id_venta){console.error('Venta inválida para finalizar:',venta);return;}setSelectedVenta(venta);setOpenFinalizarDialog(true);};const openCancelarVenta=venta=>{if(!venta||!venta.id_venta){console.error('Venta inválida para cancelar:',venta);return;}setSelectedVenta(venta);setOpenCancelarDialog(true);};const filteredVentas=ventas.filter(venta=>{// Validar que la venta tenga al menos los campos mínimos para mostrar\nif(!venta||!venta.id_venta){console.warn('Venta sin ID:',venta);return false;}// Si no hay término de búsqueda, mostrar todas las ventas válidas\nif(!searchTerm.trim()){return true;}// Validar que searchTerm no sea undefined\nconst searchLower=searchTerm.toLowerCase();return(venta.placa_vehiculo||'').toLowerCase().includes(searchLower)||(venta.numero_espacio||'').toLowerCase().includes(searchLower)||(venta.nombre_cliente||'').toLowerCase().includes(searchLower)||(venta.apellido_cliente||'').toLowerCase().includes(searchLower);});const paginatedVentas=filteredVentas.slice(page*rowsPerPage,page*rowsPerPage+rowsPerPage);const getStatusColor=estado=>{if(!estado)return'default';switch(estado){case'activa':return'warning';case'finalizada':return'success';case'cancelada':return'error';default:return'default';}};const getStatusLabel=estado=>{if(!estado)return'N/A';switch(estado){case'activa':return'Activa';case'finalizada':return'Finalizada';case'cancelada':return'Cancelada';default:return estado;}};const formatCurrency=amount=>{if(!amount||isNaN(amount))return'S/ 0.00';return new Intl.NumberFormat('es-PE',{style:'currency',currency:'PEN'}).format(amount);};// Función para manejar errores 429 con retry\nconst handleRateLimitError=(error,retryFunction)=>{var _error$response6;if(((_error$response6=error.response)===null||_error$response6===void 0?void 0:_error$response6.status)===429){const retryAfter=error.response.headers['retry-after']||5;setError(\"Demasiadas peticiones. Reintentando en \".concat(retryAfter,\" segundos...\"));setTimeout(()=>{setError(null);retryFunction();},retryAfter*1000);}else{var _error$response7,_error$response7$data;setError(((_error$response7=error.response)===null||_error$response7===void 0?void 0:(_error$response7$data=_error$response7.data)===null||_error$response7$data===void 0?void 0:_error$response7$data.error)||'Error en la operación');}};if(loading){return/*#__PURE__*/_jsx(Box,{display:\"flex\",justifyContent:\"center\",alignItems:\"center\",minHeight:\"400px\",children:/*#__PURE__*/_jsx(CircularProgress,{size:60})});}return/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',justifyContent:'space-between',alignItems:'center',mb:4},children:[/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",component:\"h1\",gutterBottom:true,sx:{color:'#1976d2',fontWeight:600},children:\"\\uD83D\\uDCB0 Gesti\\xF3n de Ventas\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body1\",color:\"text.secondary\",children:\"Administra las ventas y facturaci\\xF3n del sistema\"})]}),/*#__PURE__*/_jsx(Button,{variant:\"contained\",startIcon:/*#__PURE__*/_jsx(AddIcon,{}),onClick:handleOpenDialog,sx:{bgcolor:'#1976d2'},children:\"Nueva Venta\"})]}),/*#__PURE__*/_jsxs(Grid,{container:true,spacing:3,sx:{mb:4},children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,md:3,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{sx:{textAlign:'center'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",color:\"primary\",children:ventas.length}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:\"Total de Ventas\"})]})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,md:3,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{sx:{textAlign:'center'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",color:\"warning.main\",children:ventas.filter(v=>v.estado==='activa').length}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:\"Ventas Activas\"})]})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,md:3,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{sx:{textAlign:'center'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",color:\"success.main\",children:ventas.filter(v=>v.estado==='finalizada').length}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:\"Ventas Finalizadas\"})]})})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,sm:6,md:3,children:/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{sx:{textAlign:'center'},children:[/*#__PURE__*/_jsx(Typography,{variant:\"h4\",color:\"error.main\",children:ventas.filter(v=>v.estado==='cancelada').length}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:\"Ventas Canceladas\"})]})})})]}),error&&/*#__PURE__*/_jsx(Alert,{severity:\"error\",sx:{mb:3},onClose:()=>setError(null),children:error}),/*#__PURE__*/_jsx(Card,{sx:{mb:3},children:/*#__PURE__*/_jsx(CardContent,{children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,alignItems:\"center\",children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,placeholder:\"Buscar por placa, espacio o cliente...\",value:searchTerm,onChange:e=>setSearchTerm(e.target.value),InputProps:{startAdornment:/*#__PURE__*/_jsx(ReceiptIcon,{sx:{mr:1,color:'text.secondary'}})}})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,textAlign:\"right\",children:/*#__PURE__*/_jsx(Button,{startIcon:/*#__PURE__*/_jsx(RefreshIcon,{}),onClick:fetchData,variant:\"outlined\",children:\"Actualizar\"})})]})})}),/*#__PURE__*/_jsx(Card,{children:/*#__PURE__*/_jsxs(CardContent,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,sx:{mb:3},children:\"Lista de Ventas\"}),paginatedVentas.length===0?/*#__PURE__*/_jsxs(Box,{sx:{textAlign:'center',py:4,color:'text.secondary'},children:[/*#__PURE__*/_jsx(ReceiptIcon,{sx:{fontSize:60,mb:2,opacity:0.3}}),/*#__PURE__*/_jsx(Typography,{variant:\"h6\",gutterBottom:true,children:\"No hay ventas registradas\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:\"Comienza creando la primera venta de parqueamiento.\"})]}):/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(TableContainer,{component:Paper,children:/*#__PURE__*/_jsxs(Table,{children:[/*#__PURE__*/_jsx(TableHead,{children:/*#__PURE__*/_jsxs(TableRow,{children:[/*#__PURE__*/_jsx(TableCell,{children:\"ID\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Fecha\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Espacio\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Veh\\xEDculo\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Cliente\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Estado\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Monto\"}),/*#__PURE__*/_jsx(TableCell,{children:\"Acciones\"})]})}),/*#__PURE__*/_jsx(TableBody,{children:paginatedVentas.map(venta=>{// Validar que la venta tenga al menos los campos mínimos\nif(!venta||!venta.id_venta){console.warn('Venta inválida en renderizado:',venta);return null;}return/*#__PURE__*/_jsxs(TableRow,{hover:true,children:[/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",fontWeight:600,children:[\"#\",venta.id_venta]})}),/*#__PURE__*/_jsxs(TableCell,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",children:new Date(venta.fecha_venta).toLocaleDateString()}),/*#__PURE__*/_jsx(Typography,{variant:\"caption\",color:\"text.secondary\",children:new Date(venta.hora_entrada).toLocaleTimeString()})]}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Chip,{label:venta.numero_espacio||'N/A',color:\"primary\",size:\"small\"})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsxs(Box,{children:[/*#__PURE__*/_jsx(Typography,{variant:\"body2\",fontWeight:600,children:venta.placa_vehiculo||'Sin placa'}),/*#__PURE__*/_jsx(Chip,{label:venta.tipo_vehiculo||'N/A',color:\"secondary\",size:\"small\"})]})}),/*#__PURE__*/_jsx(TableCell,{children:venta.nombre_cliente?/*#__PURE__*/_jsxs(Typography,{variant:\"body2\",children:[venta.nombre_cliente,\" \",venta.apellido_cliente]}):/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:\"Sin cliente\"})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsx(Chip,{label:getStatusLabel(venta.estado),color:getStatusColor(venta.estado),size:\"small\"})}),/*#__PURE__*/_jsx(TableCell,{children:venta.monto_total?/*#__PURE__*/_jsx(Typography,{variant:\"body2\",fontWeight:600,color:\"success.main\",children:formatCurrency(venta.monto_total)}):/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",children:\"Pendiente\"})}),/*#__PURE__*/_jsx(TableCell,{children:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',gap:1},children:[/*#__PURE__*/_jsx(Tooltip,{title:\"Ver detalles\",children:/*#__PURE__*/_jsx(IconButton,{size:\"small\",color:\"primary\",children:/*#__PURE__*/_jsx(VisibilityIcon,{})})}),venta.estado==='activa'&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsx(Tooltip,{title:\"Finalizar venta\",children:/*#__PURE__*/_jsx(IconButton,{size:\"small\",color:\"success\",onClick:()=>openFinalizarVenta(venta),children:/*#__PURE__*/_jsx(CheckCircleIcon,{})})}),/*#__PURE__*/_jsx(Tooltip,{title:\"Cancelar venta\",children:/*#__PURE__*/_jsx(IconButton,{size:\"small\",color:\"error\",onClick:()=>openCancelarVenta(venta),children:/*#__PURE__*/_jsx(CancelIcon,{})})})]})]})})]},venta.id_venta);})})]})}),/*#__PURE__*/_jsx(TablePagination,{rowsPerPageOptions:[5,10,25],component:\"div\",count:filteredVentas.length,rowsPerPage:rowsPerPage,page:page,onPageChange:(_,newPage)=>setPage(newPage),onRowsPerPageChange:e=>{setRowsPerPage(parseInt(e.target.value,10));setPage(0);}})]})]})}),/*#__PURE__*/_jsxs(Dialog,{open:openDialog,onClose:handleCloseDialog,maxWidth:\"md\",fullWidth:true,children:[/*#__PURE__*/_jsx(DialogTitle,{children:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:1},children:[/*#__PURE__*/_jsx(AddIcon,{color:\"primary\"}),\"Nueva Venta de Parqueamiento\"]})}),/*#__PURE__*/_jsx(DialogContent,{children:/*#__PURE__*/_jsxs(Grid,{container:true,spacing:2,sx:{mt:1},children:[/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,required:true,children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Espacio\"}),/*#__PURE__*/_jsx(Select,{value:formData.id_espacio,label:\"Espacio\",onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{id_espacio:e.target.value})),children:espacios.map(espacio=>/*#__PURE__*/_jsxs(MenuItem,{value:espacio.id_espacio,children:[espacio.numero_espacio,\" - \",espacio.tipo_vehiculo,\" (S/ \",typeof espacio.tarifa_hora==='number'?espacio.tarifa_hora:0,\"/h)\"]},espacio.id_espacio))})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Cliente (Opcional)\"}),/*#__PURE__*/_jsxs(Select,{value:formData.id_cliente||'',label:\"Cliente (Opcional)\",onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{id_cliente:e.target.value||undefined})),children:[/*#__PURE__*/_jsx(MenuItem,{value:\"\",children:\"Sin cliente\"}),clientes.map(cliente=>/*#__PURE__*/_jsxs(MenuItem,{value:cliente.idCliente,children:[cliente.Nombre_Cliente,\" \",cliente.Apellido_Cliente]},cliente.idCliente))]})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Placa del Veh\\xEDculo *\",value:formData.placa_vehiculo,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{placa_vehiculo:e.target.value.toUpperCase()})),required:true,placeholder:\"ABC-123\"})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,md:6,children:/*#__PURE__*/_jsxs(FormControl,{fullWidth:true,required:true,children:[/*#__PURE__*/_jsx(InputLabel,{children:\"Tipo de Veh\\xEDculo\"}),/*#__PURE__*/_jsxs(Select,{value:formData.tipo_vehiculo,label:\"Tipo de Veh\\xEDculo\",onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{tipo_vehiculo:e.target.value})),children:[/*#__PURE__*/_jsx(MenuItem,{value:\"auto\",children:\"Auto\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"camioneta\",children:\"Camioneta\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"camion\",children:\"Cami\\xF3n\"}),/*#__PURE__*/_jsx(MenuItem,{value:\"moto\",children:\"Moto\"})]})]})}),/*#__PURE__*/_jsx(Grid,{item:true,xs:12,children:/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Observaciones\",value:formData.observaciones,onChange:e=>setFormData(_objectSpread(_objectSpread({},formData),{},{observaciones:e.target.value})),multiline:true,rows:3,placeholder:\"Observaciones adicionales sobre la venta...\"})})]})}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:handleCloseDialog,children:\"Cancelar\"}),/*#__PURE__*/_jsx(Button,{onClick:handleSubmit,variant:\"contained\",disabled:isSubmitting,sx:{bgcolor:'#1976d2'},children:isSubmitting?'Creando...':'Crear Venta'})]})]}),/*#__PURE__*/_jsxs(Dialog,{open:openFinalizarDialog,onClose:()=>setOpenFinalizarDialog(false),maxWidth:\"sm\",fullWidth:true,children:[/*#__PURE__*/_jsx(DialogTitle,{children:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:1},children:[/*#__PURE__*/_jsx(CheckCircleIcon,{color:\"success\"}),\"Finalizar Venta #\",selectedVenta===null||selectedVenta===void 0?void 0:selectedVenta.id_venta]})}),/*#__PURE__*/_jsx(DialogContent,{children:/*#__PURE__*/_jsxs(Box,{sx:{mt:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"body1\",gutterBottom:true,children:\"\\xBFEst\\xE1s seguro de que quieres finalizar esta venta?\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",sx:{mb:2},children:\"Se calcular\\xE1 el monto total basado en el tiempo transcurrido.\"}),/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Observaciones de Salida\",value:finalizarForm.observaciones_salida,onChange:e=>setFinalizarForm({observaciones_salida:e.target.value}),multiline:true,rows:3,placeholder:\"Observaciones sobre la salida del veh\\xEDculo...\"})]})}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:()=>setOpenFinalizarDialog(false),children:\"Cancelar\"}),/*#__PURE__*/_jsx(Button,{onClick:handleFinalizar,variant:\"contained\",color:\"success\",disabled:isSubmitting,children:isSubmitting?'Finalizando...':'Finalizar Venta'})]})]}),/*#__PURE__*/_jsxs(Dialog,{open:openCancelarDialog,onClose:()=>setOpenCancelarDialog(false),maxWidth:\"sm\",fullWidth:true,children:[/*#__PURE__*/_jsx(DialogTitle,{children:/*#__PURE__*/_jsxs(Box,{sx:{display:'flex',alignItems:'center',gap:1},children:[/*#__PURE__*/_jsx(CancelIcon,{color:\"error\"}),\"Cancelar Venta #\",selectedVenta===null||selectedVenta===void 0?void 0:selectedVenta.id_venta]})}),/*#__PURE__*/_jsx(DialogContent,{children:/*#__PURE__*/_jsxs(Box,{sx:{mt:2},children:[/*#__PURE__*/_jsx(Typography,{variant:\"body1\",gutterBottom:true,children:\"\\xBFEst\\xE1s seguro de que quieres cancelar esta venta?\"}),/*#__PURE__*/_jsx(Typography,{variant:\"body2\",color:\"text.secondary\",sx:{mb:2},children:\"Esta acci\\xF3n liberar\\xE1 el espacio de parqueamiento.\"}),/*#__PURE__*/_jsx(TextField,{fullWidth:true,label:\"Motivo de Cancelaci\\xF3n *\",value:cancelarForm.motivo_cancelacion,onChange:e=>setCancelarForm({motivo_cancelacion:e.target.value}),multiline:true,rows:3,placeholder:\"Especifica el motivo de la cancelaci\\xF3n...\",required:true})]})}),/*#__PURE__*/_jsxs(DialogActions,{children:[/*#__PURE__*/_jsx(Button,{onClick:()=>setOpenCancelarDialog(false),children:\"Cancelar\"}),/*#__PURE__*/_jsx(Button,{onClick:handleCancelar,variant:\"contained\",color:\"error\",disabled:isSubmitting,children:isSubmitting?'Cancelando...':'Cancelar Venta'})]})]})]});};export default Ventas;","map":{"version":3,"names":["React","useState","useEffect","Box","Typography","Button","Card","CardContent","Grid","Chip","IconButton","Tooltip","Dialog","DialogTitle","DialogContent","DialogActions","TextField","FormControl","InputLabel","Select","MenuItem","Alert","CircularProgress","Paper","Table","TableBody","TableCell","TableContainer","TableHead","TableRow","TablePagination","Add","AddIcon","Receipt","ReceiptIcon","Refresh","RefreshIcon","CheckCircle","CheckCircleIcon","Cancel","CancelIcon","Visibility","VisibilityIcon","axios","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","Ventas","ventas","setVentas","espacios","setEspacios","clientes","setClientes","loading","setLoading","error","setError","openDialog","setOpenDialog","openFinalizarDialog","setOpenFinalizarDialog","openCancelarDialog","setOpenCancelarDialog","selectedVenta","setSelectedVenta","page","setPage","rowsPerPage","setRowsPerPage","searchTerm","setSearchTerm","isSubmitting","setIsSubmitting","formData","setFormData","id_espacio","id_cliente","undefined","placa_vehiculo","tipo_vehiculo","observaciones","finalizarForm","setFinalizarForm","observaciones_salida","cancelarForm","setCancelarForm","motivo_cancelacion","fetchData","ventasResponse","espaciosResponse","clientesResponse","Promise","all","get","console","log","data","handleOpenDialog","handleCloseDialog","handleSubmit","trim","post","_error$response","_error$response$data","response","handleFinalizar","put","concat","id_venta","_error$response2","status","_error$response3","_error$response3$data","handleCancelar","_error$response4","_error$response5","_error$response5$data","openFinalizarVenta","venta","openCancelarVenta","filteredVentas","filter","warn","searchLower","toLowerCase","includes","numero_espacio","nombre_cliente","apellido_cliente","paginatedVentas","slice","getStatusColor","estado","getStatusLabel","formatCurrency","amount","isNaN","Intl","NumberFormat","style","currency","format","handleRateLimitError","retryFunction","_error$response6","retryAfter","headers","setTimeout","_error$response7","_error$response7$data","display","justifyContent","alignItems","minHeight","children","size","sx","mb","variant","component","gutterBottom","color","fontWeight","startIcon","onClick","bgcolor","container","spacing","item","xs","sm","md","textAlign","length","v","severity","onClose","fullWidth","placeholder","value","onChange","e","target","InputProps","startAdornment","mr","py","fontSize","opacity","map","hover","Date","fecha_venta","toLocaleDateString","hora_entrada","toLocaleTimeString","label","monto_total","gap","title","rowsPerPageOptions","count","onPageChange","_","newPage","onRowsPerPageChange","parseInt","open","maxWidth","mt","required","_objectSpread","espacio","tarifa_hora","cliente","idCliente","Nombre_Cliente","Apellido_Cliente","toUpperCase","multiline","rows","disabled"],"sources":["C:/Users/Asus/Documents/GitHub/Reingenieria/pos_parqueamiento_NEW/client/src/pages/Ventas/Ventas.tsx"],"sourcesContent":["import React, { useState, useEffect } from 'react';\r\nimport {\r\n  Box,\r\n  Typography,\r\n  Button,\r\n  Card,\r\n  CardContent,\r\n  Grid,\r\n  Chip,\r\n  IconButton,\r\n  Tooltip,\r\n  Dialog,\r\n  DialogTitle,\r\n  DialogContent,\r\n  DialogActions,\r\n  TextField,\r\n  FormControl,\r\n  InputLabel,\r\n  Select,\r\n  MenuItem,\r\n  Alert,\r\n  CircularProgress,\r\n  Paper,\r\n  Table,\r\n  TableBody,\r\n  TableCell,\r\n  TableContainer,\r\n  TableHead,\r\n  TableRow,\r\n  TablePagination\r\n} from '@mui/material';\r\nimport {\r\n  Add as AddIcon,\r\n  Receipt as ReceiptIcon,\r\n  Refresh as RefreshIcon,\r\n  CheckCircle as CheckCircleIcon,\r\n  Cancel as CancelIcon,\r\n  Visibility as VisibilityIcon\r\n} from '@mui/icons-material';\r\n\r\nimport axios from 'axios';\r\n\r\ninterface Venta {\r\n  id_venta: number;\r\n  fecha_venta: string;\r\n  hora_entrada: string;\r\n  hora_salida?: string | null;\r\n  tiempo_total?: number | null;\r\n  tarifa_hora: number | null;\r\n  monto_total?: number | null;\r\n  estado: 'activa' | 'finalizada' | 'cancelada' | null;\r\n  id_cliente?: number | null;\r\n  id_espacio: number;\r\n  id_usuario: number;\r\n  placa_vehiculo: string | null;\r\n  tipo_vehiculo: string | null;\r\n  observaciones?: string | null;\r\n  observaciones_salida?: string | null;\r\n  motivo_cancelacion?: string | null;\r\n  // Campos relacionados\r\n  nombre_cliente?: string | null;\r\n  apellido_cliente?: string | null;\r\n  numero_espacio?: string | null;\r\n  nombre_usuario?: string | null;\r\n}\r\n\r\ninterface VentaForm {\r\n  id_espacio: number;\r\n  id_cliente?: number;\r\n  placa_vehiculo: string;\r\n  tipo_vehiculo: string;\r\n  observaciones: string;\r\n}\r\n\r\ninterface Espacio {\r\n  id_espacio: number;\r\n  numero_espacio: string;\r\n  tipo_vehiculo: string;\r\n  tarifa_hora: number;\r\n  estado: string;\r\n}\r\n\r\ninterface Cliente {\r\n  idCliente: number;\r\n  Nombre_Cliente: string;\r\n  Apellido_Cliente: string;\r\n  ruc_Cliente?: string;\r\n}\r\n\r\nconst Ventas: React.FC = () => {\r\n\r\n  const [ventas, setVentas] = useState<Venta[]>([]);\r\n  const [espacios, setEspacios] = useState<Espacio[]>([]);\r\n  const [clientes, setClientes] = useState<Cliente[]>([]);\r\n  const [loading, setLoading] = useState(true);\r\n  const [error, setError] = useState<string | null>(null);\r\n  const [openDialog, setOpenDialog] = useState(false);\r\n  const [openFinalizarDialog, setOpenFinalizarDialog] = useState(false);\r\n  const [openCancelarDialog, setOpenCancelarDialog] = useState(false);\r\n  const [selectedVenta, setSelectedVenta] = useState<Venta | null>(null);\r\n  const [page, setPage] = useState(0);\r\n  const [rowsPerPage, setRowsPerPage] = useState(10);\r\n  const [searchTerm, setSearchTerm] = useState('');\r\n  const [isSubmitting, setIsSubmitting] = useState(false);\r\n\r\n  const [formData, setFormData] = useState<VentaForm>({\r\n    id_espacio: 0,\r\n    id_cliente: undefined,\r\n    placa_vehiculo: '',\r\n    tipo_vehiculo: 'auto',\r\n    observaciones: ''\r\n  });\r\n\r\n  const [finalizarForm, setFinalizarForm] = useState({\r\n    observaciones_salida: ''\r\n  });\r\n\r\n  const [cancelarForm, setCancelarForm] = useState({\r\n    motivo_cancelacion: ''\r\n  });\r\n\r\n  const fetchData = async () => {\r\n    try {\r\n      setLoading(true);\r\n      setError(null);\r\n      \r\n      const [ventasResponse, espaciosResponse, clientesResponse] = await Promise.all([\r\n        axios.get('/api/ventas'),\r\n        axios.get('/api/espacios/libres'),\r\n        axios.get('/api/clientes')\r\n      ]);\r\n\r\n      console.log('Ventas recibidas:', ventasResponse.data.data);\r\n      console.log('Espacios recibidos:', espaciosResponse.data.data);\r\n      console.log('Clientes recibidos:', clientesResponse.data.data);\r\n      \r\n      setVentas(ventasResponse.data.data);\r\n      setEspacios(espaciosResponse.data.data);\r\n      setClientes(clientesResponse.data.data);\r\n    } catch (error: any) {\r\n      console.error('Error al cargar datos:', error);\r\n      setError('Error al cargar los datos');\r\n    } finally {\r\n      setLoading(false);\r\n    }\r\n  };\r\n\r\n  useEffect(() => {\r\n    fetchData();\r\n  }, []);\r\n\r\n  const handleOpenDialog = () => {\r\n    setFormData({\r\n      id_espacio: 0,\r\n      id_cliente: undefined,\r\n      placa_vehiculo: '',\r\n      tipo_vehiculo: 'auto',\r\n      observaciones: ''\r\n    });\r\n    setOpenDialog(true);\r\n  };\r\n\r\n  const handleCloseDialog = () => {\r\n    setOpenDialog(false);\r\n    setFormData({\r\n      id_espacio: 0,\r\n      id_cliente: undefined,\r\n      placa_vehiculo: '',\r\n      tipo_vehiculo: 'auto',\r\n      observaciones: ''\r\n    });\r\n  };\r\n\r\n  const handleSubmit = async () => {\r\n    if (isSubmitting) return;\r\n    \r\n    try {\r\n      if (!formData.id_espacio || !formData.placa_vehiculo.trim()) {\r\n        setError('Por favor complete todos los campos requeridos');\r\n        return;\r\n      }\r\n\r\n      setIsSubmitting(true);\r\n      await axios.post('/api/ventas', formData);\r\n      fetchData();\r\n      handleCloseDialog();\r\n    } catch (error: any) {\r\n      console.error('Error al crear venta:', error);\r\n      setError(error.response?.data?.error || 'Error al crear la venta');\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const handleFinalizar = async () => {\r\n    if (!selectedVenta || isSubmitting) return;\r\n    \r\n    try {\r\n      setIsSubmitting(true);\r\n      await axios.put(`/api/ventas/${selectedVenta.id_venta}/finalizar`, finalizarForm);\r\n      fetchData();\r\n      setOpenFinalizarDialog(false);\r\n      setSelectedVenta(null);\r\n      setFinalizarForm({ observaciones_salida: '' });\r\n    } catch (error: any) {\r\n      console.error('Error al finalizar venta:', error);\r\n      if (error.response?.status === 429) {\r\n        setError('Demasiadas peticiones. Por favor espera un momento antes de intentar nuevamente.');\r\n      } else {\r\n        setError(error.response?.data?.error || 'Error al finalizar la venta');\r\n      }\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const handleCancelar = async () => {\r\n    if (!selectedVenta || isSubmitting) return;\r\n    \r\n    try {\r\n      setIsSubmitting(true);\r\n      await axios.put(`/api/ventas/${selectedVenta.id_venta}/cancelar`, cancelarForm);\r\n      fetchData();\r\n      setOpenCancelarDialog(false);\r\n      setSelectedVenta(null);\r\n      setCancelarForm({ motivo_cancelacion: '' });\r\n    } catch (error: any) {\r\n      console.error('Error al cancelar venta:', error);\r\n      if (error.response?.status === 429) {\r\n        setError('Demasiadas peticiones. Por favor espera un momento antes de intentar nuevamente.');\r\n      } else {\r\n        setError(error.response?.data?.error || 'Error al cancelar la venta');\r\n      }\r\n    } finally {\r\n      setIsSubmitting(false);\r\n    }\r\n  };\r\n\r\n  const openFinalizarVenta = (venta: Venta) => {\r\n    if (!venta || !venta.id_venta) {\r\n      console.error('Venta inválida para finalizar:', venta);\r\n      return;\r\n    }\r\n    setSelectedVenta(venta);\r\n    setOpenFinalizarDialog(true);\r\n  };\r\n\r\n  const openCancelarVenta = (venta: Venta) => {\r\n    if (!venta || !venta.id_venta) {\r\n      console.error('Venta inválida para cancelar:', venta);\r\n      return;\r\n    }\r\n    setSelectedVenta(venta);\r\n    setOpenCancelarDialog(true);\r\n  };\r\n\r\n  const filteredVentas = ventas.filter(venta => {\r\n    // Validar que la venta tenga al menos los campos mínimos para mostrar\r\n    if (!venta || !venta.id_venta) {\r\n      console.warn('Venta sin ID:', venta);\r\n      return false;\r\n    }\r\n    \r\n    // Si no hay término de búsqueda, mostrar todas las ventas válidas\r\n    if (!searchTerm.trim()) {\r\n      return true;\r\n    }\r\n    \r\n    // Validar que searchTerm no sea undefined\r\n    const searchLower = searchTerm.toLowerCase();\r\n    \r\n    return (\r\n      (venta.placa_vehiculo || '').toLowerCase().includes(searchLower) ||\r\n      (venta.numero_espacio || '').toLowerCase().includes(searchLower) ||\r\n      (venta.nombre_cliente || '').toLowerCase().includes(searchLower) ||\r\n      (venta.apellido_cliente || '').toLowerCase().includes(searchLower)\r\n    );\r\n  });\r\n\r\n  const paginatedVentas = filteredVentas.slice(\r\n    page * rowsPerPage,\r\n    page * rowsPerPage + rowsPerPage\r\n  );\r\n\r\n  const getStatusColor = (estado: string | null | undefined) => {\r\n    if (!estado) return 'default';\r\n    \r\n    switch (estado) {\r\n      case 'activa':\r\n        return 'warning';\r\n      case 'finalizada':\r\n        return 'success';\r\n      case 'cancelada':\r\n        return 'error';\r\n      default:\r\n        return 'default';\r\n    }\r\n  };\r\n\r\n  const getStatusLabel = (estado: string | null | undefined) => {\r\n    if (!estado) return 'N/A';\r\n    \r\n    switch (estado) {\r\n      case 'activa':\r\n        return 'Activa';\r\n      case 'finalizada':\r\n        return 'Finalizada';\r\n      case 'cancelada':\r\n        return 'Cancelada';\r\n      default:\r\n        return estado;\r\n    }\r\n  };\r\n\r\n  const formatCurrency = (amount: number) => {\r\n    if (!amount || isNaN(amount)) return 'S/ 0.00';\r\n    \r\n    return new Intl.NumberFormat('es-PE', {\r\n      style: 'currency',\r\n      currency: 'PEN'\r\n    }).format(amount);\r\n  };\r\n\r\n  // Función para manejar errores 429 con retry\r\n  const handleRateLimitError = (error: any, retryFunction: () => Promise<void>) => {\r\n    if (error.response?.status === 429) {\r\n      const retryAfter = error.response.headers['retry-after'] || 5;\r\n      setError(`Demasiadas peticiones. Reintentando en ${retryAfter} segundos...`);\r\n      \r\n      setTimeout(() => {\r\n        setError(null);\r\n        retryFunction();\r\n      }, retryAfter * 1000);\r\n    } else {\r\n      setError(error.response?.data?.error || 'Error en la operación');\r\n    }\r\n  };\r\n\r\n\r\n\r\n  if (loading) {\r\n    return (\r\n      <Box display=\"flex\" justifyContent=\"center\" alignItems=\"center\" minHeight=\"400px\">\r\n        <CircularProgress size={60} />\r\n      </Box>\r\n    );\r\n  }\r\n\r\n  return (\r\n    <Box>\r\n      {/* Header */}\r\n      <Box sx={{ display: 'flex', justifyContent: 'space-between', alignItems: 'center', mb: 4 }}>\r\n        <Box>\r\n          <Typography variant=\"h4\" component=\"h1\" gutterBottom sx={{ color: '#1976d2', fontWeight: 600 }}>\r\n            💰 Gestión de Ventas\r\n          </Typography>\r\n          <Typography variant=\"body1\" color=\"text.secondary\">\r\n            Administra las ventas y facturación del sistema\r\n          </Typography>\r\n        </Box>\r\n        \r\n        <Button\r\n          variant=\"contained\"\r\n          startIcon={<AddIcon />}\r\n          onClick={handleOpenDialog}\r\n          sx={{ bgcolor: '#1976d2' }}\r\n        >\r\n          Nueva Venta\r\n        </Button>\r\n      </Box>\r\n\r\n      {/* Estadísticas rápidas */}\r\n      <Grid container spacing={3} sx={{ mb: 4 }}>\r\n        <Grid item xs={12} sm={6} md={3}>\r\n          <Card>\r\n            <CardContent sx={{ textAlign: 'center' }}>\r\n              <Typography variant=\"h4\" color=\"primary\">\r\n                {ventas.length}\r\n              </Typography>\r\n              <Typography variant=\"body2\" color=\"text.secondary\">\r\n                Total de Ventas\r\n              </Typography>\r\n            </CardContent>\r\n          </Card>\r\n        </Grid>\r\n        <Grid item xs={12} sm={6} md={3}>\r\n          <Card>\r\n            <CardContent sx={{ textAlign: 'center' }}>\r\n              <Typography variant=\"h4\" color=\"warning.main\">\r\n                {ventas.filter(v => v.estado === 'activa').length}\r\n              </Typography>\r\n              <Typography variant=\"body2\" color=\"text.secondary\">\r\n                Ventas Activas\r\n              </Typography>\r\n            </CardContent>\r\n          </Card>\r\n        </Grid>\r\n        <Grid item xs={12} sm={6} md={3}>\r\n          <Card>\r\n            <CardContent sx={{ textAlign: 'center' }}>\r\n              <Typography variant=\"h4\" color=\"success.main\">\r\n                {ventas.filter(v => v.estado === 'finalizada').length}\r\n              </Typography>\r\n              <Typography variant=\"body2\" color=\"text.secondary\">\r\n                Ventas Finalizadas\r\n              </Typography>\r\n            </CardContent>\r\n          </Card>\r\n        </Grid>\r\n        <Grid item xs={12} sm={6} md={3}>\r\n          <Card>\r\n            <CardContent sx={{ textAlign: 'center' }}>\r\n              <Typography variant=\"h4\" color=\"error.main\">\r\n                {ventas.filter(v => v.estado === 'cancelada').length}\r\n              </Typography>\r\n              <Typography variant=\"body2\" color=\"text.secondary\">\r\n                Ventas Canceladas\r\n              </Typography>\r\n            </CardContent>\r\n          </Card>\r\n        </Grid>\r\n      </Grid>\r\n\r\n      {/* Mensaje de error */}\r\n      {error && (\r\n        <Alert severity=\"error\" sx={{ mb: 3 }} onClose={() => setError(null)}>\r\n          {error}\r\n        </Alert>\r\n      )}\r\n\r\n      {/* Filtros y búsqueda */}\r\n      <Card sx={{ mb: 3 }}>\r\n        <CardContent>\r\n          <Grid container spacing={2} alignItems=\"center\">\r\n            <Grid item xs={12} md={6}>\r\n              <TextField\r\n                fullWidth\r\n                placeholder=\"Buscar por placa, espacio o cliente...\"\r\n                value={searchTerm}\r\n                onChange={(e) => setSearchTerm(e.target.value)}\r\n                InputProps={{\r\n                  startAdornment: <ReceiptIcon sx={{ mr: 1, color: 'text.secondary' }} />\r\n                }}\r\n              />\r\n            </Grid>\r\n            <Grid item xs={12} md={6} textAlign=\"right\">\r\n              <Button\r\n                startIcon={<RefreshIcon />}\r\n                onClick={fetchData}\r\n                variant=\"outlined\"\r\n              >\r\n                Actualizar\r\n              </Button>\r\n            </Grid>\r\n          </Grid>\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Tabla de ventas */}\r\n      <Card>\r\n        <CardContent>\r\n          <Typography variant=\"h6\" gutterBottom sx={{ mb: 3 }}>\r\n            Lista de Ventas\r\n          </Typography>\r\n\r\n          {paginatedVentas.length === 0 ? (\r\n            <Box sx={{ textAlign: 'center', py: 4, color: 'text.secondary' }}>\r\n              <ReceiptIcon sx={{ fontSize: 60, mb: 2, opacity: 0.3 }} />\r\n              <Typography variant=\"h6\" gutterBottom>\r\n                No hay ventas registradas\r\n              </Typography>\r\n              <Typography variant=\"body2\">\r\n                Comienza creando la primera venta de parqueamiento.\r\n              </Typography>\r\n            </Box>\r\n          ) : (\r\n            <>\r\n              <TableContainer component={Paper}>\r\n                <Table>\r\n                  <TableHead>\r\n                    <TableRow>\r\n                      <TableCell>ID</TableCell>\r\n                      <TableCell>Fecha</TableCell>\r\n                      <TableCell>Espacio</TableCell>\r\n                      <TableCell>Vehículo</TableCell>\r\n                      <TableCell>Cliente</TableCell>\r\n                      <TableCell>Estado</TableCell>\r\n                      <TableCell>Monto</TableCell>\r\n                      <TableCell>Acciones</TableCell>\r\n                    </TableRow>\r\n                  </TableHead>\r\n                  <TableBody>\r\n                                                              {paginatedVentas.map((venta) => {\r\n                       // Validar que la venta tenga al menos los campos mínimos\r\n                       if (!venta || !venta.id_venta) {\r\n                         console.warn('Venta inválida en renderizado:', venta);\r\n                         return null;\r\n                       }\r\n                       \r\n                       return (\r\n                         <TableRow key={venta.id_venta} hover>\r\n                           <TableCell>\r\n                             <Typography variant=\"body2\" fontWeight={600}>\r\n                               #{venta.id_venta}\r\n                             </Typography>\r\n                           </TableCell>\r\n                           <TableCell>\r\n                             <Typography variant=\"body2\">\r\n                               {new Date(venta.fecha_venta).toLocaleDateString()}\r\n                             </Typography>\r\n                             <Typography variant=\"caption\" color=\"text.secondary\">\r\n                               {new Date(venta.hora_entrada).toLocaleTimeString()}\r\n                             </Typography>\r\n                           </TableCell>\r\n                           <TableCell>\r\n                             <Chip \r\n                               label={venta.numero_espacio || 'N/A'} \r\n                               color=\"primary\" \r\n                               size=\"small\"\r\n                             />\r\n                           </TableCell>\r\n                           <TableCell>\r\n                             <Box>\r\n                               <Typography variant=\"body2\" fontWeight={600}>\r\n                                 {venta.placa_vehiculo || 'Sin placa'}\r\n                               </Typography>\r\n                               <Chip \r\n                                 label={venta.tipo_vehiculo || 'N/A'} \r\n                                 color=\"secondary\" \r\n                                 size=\"small\"\r\n                               />\r\n                             </Box>\r\n                           </TableCell>\r\n                           <TableCell>\r\n                             {venta.nombre_cliente ? (\r\n                               <Typography variant=\"body2\">\r\n                                 {venta.nombre_cliente} {venta.apellido_cliente}\r\n                               </Typography>\r\n                             ) : (\r\n                               <Typography variant=\"body2\" color=\"text.secondary\">\r\n                                 Sin cliente\r\n                               </Typography>\r\n                             )}\r\n                           </TableCell>\r\n                           <TableCell>\r\n                             <Chip\r\n                               label={getStatusLabel(venta.estado)}\r\n                               color={getStatusColor(venta.estado) as any}\r\n                               size=\"small\"\r\n                             />\r\n                           </TableCell>\r\n                           <TableCell>\r\n                             {venta.monto_total ? (\r\n                               <Typography variant=\"body2\" fontWeight={600} color=\"success.main\">\r\n                                 {formatCurrency(venta.monto_total)}\r\n                               </Typography>\r\n                             ) : (\r\n                               <Typography variant=\"body2\" color=\"text.secondary\">\r\n                                 Pendiente\r\n                               </Typography>\r\n                             )}\r\n                           </TableCell>\r\n                           <TableCell>\r\n                             <Box sx={{ display: 'flex', gap: 1 }}>\r\n                               <Tooltip title=\"Ver detalles\">\r\n                                 <IconButton size=\"small\" color=\"primary\">\r\n                                   <VisibilityIcon />\r\n                                 </IconButton>\r\n                               </Tooltip>\r\n                               \r\n                               {venta.estado === 'activa' && (\r\n                                 <>\r\n                                   <Tooltip title=\"Finalizar venta\">\r\n                                     <IconButton \r\n                                       size=\"small\" \r\n                                       color=\"success\"\r\n                                       onClick={() => openFinalizarVenta(venta)}\r\n                                     >\r\n                                       <CheckCircleIcon />\r\n                                     </IconButton>\r\n                                   </Tooltip>\r\n                                   \r\n                                   <Tooltip title=\"Cancelar venta\">\r\n                                     <IconButton \r\n                                       size=\"small\" \r\n                                       color=\"error\"\r\n                                       onClick={() => openCancelarVenta(venta)}\r\n                                     >\r\n                                       <CancelIcon />\r\n                                     </IconButton>\r\n                                   </Tooltip>\r\n                                 </>\r\n                               )}\r\n                             </Box>\r\n                           </TableCell>\r\n                         </TableRow>\r\n                       );\r\n                     })}\r\n                  </TableBody>\r\n                </Table>\r\n              </TableContainer>\r\n              \r\n              <TablePagination\r\n                rowsPerPageOptions={[5, 10, 25]}\r\n                component=\"div\"\r\n                count={filteredVentas.length}\r\n                rowsPerPage={rowsPerPage}\r\n                page={page}\r\n                onPageChange={(_, newPage) => setPage(newPage)}\r\n                onRowsPerPageChange={(e) => {\r\n                  setRowsPerPage(parseInt(e.target.value, 10));\r\n                  setPage(0);\r\n                }}\r\n              />\r\n            </>\r\n          )}\r\n        </CardContent>\r\n      </Card>\r\n\r\n      {/* Dialog para crear nueva venta */}\r\n      <Dialog open={openDialog} onClose={handleCloseDialog} maxWidth=\"md\" fullWidth>\r\n        <DialogTitle>\r\n          <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\r\n            <AddIcon color=\"primary\" />\r\n            Nueva Venta de Parqueamiento\r\n          </Box>\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          <Grid container spacing={2} sx={{ mt: 1 }}>\r\n            <Grid item xs={12} md={6}>\r\n              <FormControl fullWidth required>\r\n                <InputLabel>Espacio</InputLabel>\r\n                <Select\r\n                  value={formData.id_espacio}\r\n                  label=\"Espacio\"\r\n                  onChange={(e) => setFormData({ ...formData, id_espacio: e.target.value as number })}\r\n                >\r\n                  {espacios.map((espacio) => (\r\n                    <MenuItem key={espacio.id_espacio} value={espacio.id_espacio}>\r\n                      {espacio.numero_espacio} - {espacio.tipo_vehiculo} (S/ {typeof espacio.tarifa_hora === 'number' ? espacio.tarifa_hora : 0}/h)\r\n                    </MenuItem>\r\n                  ))}\r\n                </Select>\r\n              </FormControl>\r\n            </Grid>\r\n            \r\n            <Grid item xs={12} md={6}>\r\n              <FormControl fullWidth>\r\n                <InputLabel>Cliente (Opcional)</InputLabel>\r\n                <Select\r\n                  value={formData.id_cliente || ''}\r\n                  label=\"Cliente (Opcional)\"\r\n                  onChange={(e) => setFormData({ ...formData, id_cliente: e.target.value as number || undefined })}\r\n                >\r\n                  <MenuItem value=\"\">Sin cliente</MenuItem>\r\n                  {clientes.map((cliente) => (\r\n                    <MenuItem key={cliente.idCliente} value={cliente.idCliente}>\r\n                      {cliente.Nombre_Cliente} {cliente.Apellido_Cliente}\r\n                    </MenuItem>\r\n                  ))}\r\n                </Select>\r\n              </FormControl>\r\n            </Grid>\r\n            \r\n            <Grid item xs={12} md={6}>\r\n              <TextField\r\n                fullWidth\r\n                label=\"Placa del Vehículo *\"\r\n                value={formData.placa_vehiculo}\r\n                onChange={(e) => setFormData({ ...formData, placa_vehiculo: e.target.value.toUpperCase() })}\r\n                required\r\n                placeholder=\"ABC-123\"\r\n              />\r\n            </Grid>\r\n            \r\n            <Grid item xs={12} md={6}>\r\n              <FormControl fullWidth required>\r\n                <InputLabel>Tipo de Vehículo</InputLabel>\r\n                <Select\r\n                  value={formData.tipo_vehiculo}\r\n                  label=\"Tipo de Vehículo\"\r\n                  onChange={(e) => setFormData({ ...formData, tipo_vehiculo: e.target.value as string })}\r\n                >\r\n                  <MenuItem value=\"auto\">Auto</MenuItem>\r\n                  <MenuItem value=\"camioneta\">Camioneta</MenuItem>\r\n                  <MenuItem value=\"camion\">Camión</MenuItem>\r\n                  <MenuItem value=\"moto\">Moto</MenuItem>\r\n                </Select>\r\n              </FormControl>\r\n            </Grid>\r\n            \r\n            <Grid item xs={12}>\r\n              <TextField\r\n                fullWidth\r\n                label=\"Observaciones\"\r\n                value={formData.observaciones}\r\n                onChange={(e) => setFormData({ ...formData, observaciones: e.target.value })}\r\n                multiline\r\n                rows={3}\r\n                placeholder=\"Observaciones adicionales sobre la venta...\"\r\n              />\r\n            </Grid>\r\n          </Grid>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={handleCloseDialog}>Cancelar</Button>\r\n                     <Button \r\n             onClick={handleSubmit} \r\n             variant=\"contained\" \r\n             disabled={isSubmitting}\r\n             sx={{ bgcolor: '#1976d2' }}\r\n           >\r\n             {isSubmitting ? 'Creando...' : 'Crear Venta'}\r\n           </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      {/* Dialog para finalizar venta */}\r\n      <Dialog open={openFinalizarDialog} onClose={() => setOpenFinalizarDialog(false)} maxWidth=\"sm\" fullWidth>\r\n        <DialogTitle>\r\n          <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\r\n            <CheckCircleIcon color=\"success\" />\r\n            Finalizar Venta #{selectedVenta?.id_venta}\r\n          </Box>\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          <Box sx={{ mt: 2 }}>\r\n            <Typography variant=\"body1\" gutterBottom>\r\n              ¿Estás seguro de que quieres finalizar esta venta?\r\n            </Typography>\r\n            <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mb: 2 }}>\r\n              Se calculará el monto total basado en el tiempo transcurrido.\r\n            </Typography>\r\n            \r\n            <TextField\r\n              fullWidth\r\n              label=\"Observaciones de Salida\"\r\n              value={finalizarForm.observaciones_salida}\r\n              onChange={(e) => setFinalizarForm({ observaciones_salida: e.target.value })}\r\n              multiline\r\n              rows={3}\r\n              placeholder=\"Observaciones sobre la salida del vehículo...\"\r\n            />\r\n          </Box>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => setOpenFinalizarDialog(false)}>Cancelar</Button>\r\n                     <Button \r\n             onClick={handleFinalizar} \r\n             variant=\"contained\" \r\n             color=\"success\"\r\n             disabled={isSubmitting}\r\n           >\r\n             {isSubmitting ? 'Finalizando...' : 'Finalizar Venta'}\r\n           </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n\r\n      {/* Dialog para cancelar venta */}\r\n      <Dialog open={openCancelarDialog} onClose={() => setOpenCancelarDialog(false)} maxWidth=\"sm\" fullWidth>\r\n        <DialogTitle>\r\n          <Box sx={{ display: 'flex', alignItems: 'center', gap: 1 }}>\r\n            <CancelIcon color=\"error\" />\r\n            Cancelar Venta #{selectedVenta?.id_venta}\r\n          </Box>\r\n        </DialogTitle>\r\n        <DialogContent>\r\n          <Box sx={{ mt: 2 }}>\r\n            <Typography variant=\"body1\" gutterBottom>\r\n              ¿Estás seguro de que quieres cancelar esta venta?\r\n            </Typography>\r\n            <Typography variant=\"body2\" color=\"text.secondary\" sx={{ mb: 2 }}>\r\n              Esta acción liberará el espacio de parqueamiento.\r\n            </Typography>\r\n            \r\n            <TextField\r\n              fullWidth\r\n              label=\"Motivo de Cancelación *\"\r\n              value={cancelarForm.motivo_cancelacion}\r\n              onChange={(e) => setCancelarForm({ motivo_cancelacion: e.target.value })}\r\n              multiline\r\n              rows={3}\r\n              placeholder=\"Especifica el motivo de la cancelación...\"\r\n              required\r\n            />\r\n          </Box>\r\n        </DialogContent>\r\n        <DialogActions>\r\n          <Button onClick={() => setOpenCancelarDialog(false)}>Cancelar</Button>\r\n                     <Button \r\n             onClick={handleCancelar} \r\n             variant=\"contained\" \r\n             color=\"error\"\r\n             disabled={isSubmitting}\r\n           >\r\n             {isSubmitting ? 'Cancelando...' : 'Cancelar Venta'}\r\n           </Button>\r\n        </DialogActions>\r\n      </Dialog>\r\n    </Box>\r\n  );\r\n};\r\n\r\nexport default Ventas;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}